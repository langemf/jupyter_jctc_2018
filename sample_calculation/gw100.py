# This is a helper object for a few scripts
# This contains all of the gw100 molecules and their important properties - number of frozen orbitals, coordinates (taken from original GW paper)
# It will return a Mol object that can be used in the driver file

from collections import OrderedDict

class GW100(object):
    def __init__(self, basis='def2tzvpp'):
        # Xe, Rb, I, Ag require ECP for def2-tzvpp
        molecules=['he',
                   'ne',
                   'ar',
                   'kr',
                   'xe',
                   'h2',
                   'li2',
                   'na2',
                   'na4',
                   'na6',
                   'k2',
                   'rb2',
                   'n2',
                   'p2',
                   'as2',
                   'f2',
                   'cl2',
                   'br2',
                   'i2',
                   'ch4',
                   'c2h6',
                   'c3h8',
                   'c4h10',
                   'c2h4',
                   'c2h2',
                   'c4',
                   'c3h6',
                   'c6h6',
                   'c8h8',
                   'c5h6',
                   'c2h3f',
                   'c2h3cl',
                   'c2h3br',
                   'c2h3i',
                   'cf4',
                   'ccl4',
                   'cbr4',
                   'ci4',
                   'sih4',
                   'geh4',
                   'si2h6',
                   'si5h12',
                   'lih',
                   'kh',
                   'bh3',
                   'b2h6',
                   'nh3',
                   'hn3',
                   'ph3',
                   'ash3',
                   'sh2',
                   'fh',
                   'clh',
                   'lif',
                   'f2mg',
                   'tif4',
                   'alf3',
                   'bf',
                   'sf4',
                   'brk',
                   'gacl',
                   'nacl',
                   'mgcl2',
                   'ali3',
                   'bn',
                   'nch',
                   'pn',
                   'h2nnh2',
                   'h2co',
                   'ch4o',
                   'c2h6o',
                   'c2h4o',
                   'c4h10o',
                   'ch2o2',
                   'hooh',
                   'h2o',
                   'co2',
                   'cs2',
                   'ocs',
                   'ocse',
                   'co',
                   'o3',
                   'so2',
                   'beo',
                   'mgo',
                   'c7h8',
                   'c8h10',
                   'c6f6',
                   'c6h5oh',
                   'c6h5nh2',
                   'c5h5n',
                   'c5h5n5o',
                   'c5h5n5',
                   'c4h5n3o',
                   'c5h6n2o2',
                   'c4h4n2o2',
                   'ag2',
                   'cu2',
                   'nccu',
                   'con2h4']
        self.molecules = OrderedDict()
        for molecule in molecules:
            self.molecules[molecule] = GW100Molecule(molecule, basis)


class GW100Molecule(object):
    def __init__(self, formula, basis='def2tzvpp', pseudo=None):
        if pseudo is None:
            pseudo = basis
        self.formula = formula
        self.basis = basis
        self.atoms, self.frozen, self.nip = get_molecule_from_gw100(formula)
        #mol = build_mol(self.atoms, self.basis, ecp='def2tzvpp')
        #self.nvalence = mol.nelectron
        ecp = dict()
        atoms_with_pseudo = ['Xe', 'Ag', 'I', 'Rb']
        for atom in self.atoms:
            name = atom[0]
            if name in atoms_with_pseudo:
                ecp[name] = pseudo
        self.mol = build_mol(self.atoms, self.basis, ecp)
        self.nelectron = self.mol.nelectron
        self.nbasis = self.mol.nao_nr()
        f = open('reference/eomccsd_ip.dat')
        self.ip_ccsdt = None
        for l in f:
            line = l.strip('\n')
            form, name, ip = line.split(',')
            form = form.strip()
            ip = ip.strip()
            if get_id_from_formula(self.formula) == get_id_from_formula(form):
                self.ip_ccsdt = float(ip)
        f.close()


from pyscf import gto
def build_mol(atoms, basis='ccpvdz', ecp=None):
    mol = gto.Mole()
    mol.unit = 'A'
    mol.atom = atoms
    mol.basis = basis
    mol.ecp = ecp
    mol.verbose = 0
    mol.build()

    return mol


def get_molecule_from_gw100(formula):
    if formula.lower() == 'he': 
        atoms = [['He',(0.0, 0.0, 0.0)]]
        frozen = range(0)
        nip = 2
    elif formula.lower() == 'ne': 
        atoms = [['Ne',(0.0, 0.0, 0.0)]]
        frozen = range(1)
        nip = 8
    elif formula.lower() == 'ar': 
        atoms = [['Ar',(0.0, 0.0, 0.0)]]
        frozen = range(5)
        nip = 8
    elif formula.lower() == 'kr': 
        atoms = [['Kr',(0.0, 0.0, 0.0)]]
        frozen = range(14)
        nip = 8
    elif formula.lower() == 'xe': 
        atoms = [['Xe',(0.0, 0.0, 0.0)]]
        frozen = range(9)
        nip = 18
    elif formula.lower() == 'h2': 
        atoms = [['H',(0.0000, 0.0000, 0.0000)],
            #['H', (0.0000, 0.0000, 0.767395)]] # gw27
            ['H', (0.0000, 0.0000, 0.74144)]]  # gw100
        frozen = range(0)
        nip = 2
    elif formula.lower() == 'li2': 
        atoms = [['Li',(0.0000, 0.0000, 0.0000)],
            ['Li', (0.0000, 0.0000, 2.6729)]]
        frozen = range(0)
        nip = 6
    elif formula.lower() == 'na2': 
        atoms = [['Na',(0.0000, 0.0000, 0.0000)],
            ['Na', (0.0000, 0.0000, 3.0789)]]
        frozen = range(2)
        nip = 18
    elif formula.lower() == 'na4': 
        atoms = [['Na',(0.0002445, -0.0998053, 1.5471126)],
            ['Na', (-0.0002444, 3.1776586, 0.0486374)],
            ['Na', (0.0002444, 0.0997722, -1.5472150)],
            ['Na', (-0.0002444, -3.1776254, -0.0485350)]]
        frozen = range(4)
        nip = 36
    elif formula.lower() == 'na6': 
        atoms = [['Na',(-2.4732949, -1.7969539, -0.2367313)],
            ['Na', (-2.4732949, 1.7969539, -0.2367313)],
            ['Na', (0.9447146, -2.9075325, -0.2367313)],
            ['Na', (0.9447146, 2.9075325, -0.2367313)],
            ['Na', (3.0571606, 0.0000000, -0.2367313)],
            ['Na', (0.0000000, 0.0000000, 1.1836565)]]
        frozen = range(6)
        nip = 54
    elif formula.lower() == 'k2': 
        atoms = [['K',(0.0000, 0.0000, 0.0000)],
            ['K', (0.0000, 0.0000, 3.9051)]]
        frozen = range(10)
        nip = 18
    elif formula.lower() == 'rb2': 
        atoms = [['Rb',(0.0000, 0.0000, 0.0000)],
            ['Rb', (0.0000, 0.0000, 4.12256)]]
        frozen = range(0)
        nip = 18
    elif formula.lower() == 'n2': 
        atoms = [['N',(0.0000, 0.0000, 0.0000)],
                ['N',(0.0000, 0.0000, 1.0977)]]
        frozen = range(2)
        nip = 10
    elif formula.lower() == 'p2': 
        atoms = [['P',(0.0000, 0.0000, 0.0000)],
            ['P', (0.0000, 0.0000, 1.8931)]]
        frozen = range(10)
        nip = 10
    elif formula.lower() == 'as2': 
        atoms = [['As',(0.0000, 0.0000, 0.0000)],
            ['As', (0.0000, 0.0000, 2.1026)]]
        frozen = range(18)
        nip = 10
    elif formula.lower() == 'f2': 
        atoms = [['F',(0.0000, 0.0000, 0.0000)],
            ['F', (0.0000, 0.0000, 1.4119)]]
        frozen = range(2)
        nip = 14
    elif formula.lower() == 'cl2': 
        atoms = [['Cl',(0.0000, 0.0000, 0.0000)],
            ['Cl', (0.0000, 0.0000, 1.9878)]]
        frozen = range(10)
        nip = 14
    elif formula.lower() == 'br2': 
        atoms = [['Br',(0.0000, 0.0000, 0.0000)],
            ['Br', (0.0000, 0.0000, 2.2811)]]
        frozen = range(28)
        nip = 14
    elif formula.lower() == 'i2': 
        atoms = [['I',(0.0000, 0.0000, 0.0000)],
            ['I', (0.0000, 0.0000, 2.6663)]]
        frozen = range(8)
        nip = 34
    elif formula.lower() == 'ch4': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['H', (0.6276, -0.6275, 0.6276)],
            ['H', (-0.6276, 0.6276, 0.6276)],
            ['H', (-0.6276, -0.6276, -0.6276)],
            ['H', (0.6276, 0.6276, -0.6276)]]
        frozen = range(1)
        nip = 8
    elif formula.lower() == 'c2h6': 
        atoms = [['C',(0.000100, 0.765700, 0.000000)],
            ['C', (-0.000100, -0.769300, 0.000000)],
            ['H', (-0.134892, 1.160801, -1.011192)],
            ['H', (-0.808178, 1.160889, 0.622373)],
            ['H', (0.943359, 1.160660, 0.388723)],
            ['H', (0.808348, -1.164489, -0.622151)],
            ['H', (0.134598, -1.164401, 1.011231)],
            ['H', (-0.943239, -1.164260, -0.389014)]]
        frozen = range(2)
        nip = 14
    elif formula.lower() == 'c3h8': 
        atoms = [['C',(0.0000, 0.5863, -0.0000)],
            ['C', (-1.2681, -0.2626, 0.0000)],
            ['C', (1.2681, -0.2626, -0.0000)],
            ['H', (0.0000, 1.2449, 0.8760)],
            ['H', (-0.0003, 1.2453, -0.8758)],
            ['H', (-2.1576, 0.3742, 0.0000)],
            ['H', (2.1576, 0.3743, 0.0000)],
            ['H', (-1.3271, -0.9014, 0.8800)],
            ['H', (-1.3271, -0.9014, -0.8800)],
            ['H', (1.3271, -0.9014, -0.8800)],
            ['H', (1.3272, -0.9014, 0.8800)]]
        frozen = range(3)
        nip = 20
    elif formula.lower() == 'c4h10': 
        atoms = [['C',(-0.5698992, 0.0010721, -0.5106280)],
            ['C', (-1.9574388, -0.0010272, 0.1310139)],
            ['C', (0.5699130, 0.0010684, 0.5106802)],
            ['H', (-2.1019869, -0.8898549, 0.7620598)],
            ['H', (-2.1011958, 0.8826120, 0.7695094)],
            ['H', (-2.7542204, 0.0025732, -0.6252247)],
            ['H', (-0.4643309, -0.8776931, -1.1680830)],
            ['H', (-0.4658369, 0.8818734, -1.1655696)],
            ['H', (0.4658491, 0.8818113, 1.1656828)],
            ['H', (0.4644008, -0.8777422, 1.1680681)],
            ['C', (1.9574251, -0.0010272, -0.1310574)],
            ['H', (2.7542844, 0.0069401, 0.6250702)],
            ['H', (2.1035257, -0.8919972, -0.7587064)],
            ['H', (2.0995094, 0.8804516, -0.7729107)]]
        frozen = range(4)
        nip = 26
    elif formula.lower() == 'c2h4': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['C', (0.0000, 0.0000, 1.3290)],
            ['H', (0.9235, 0.0000, -0.5637)],
            ['H', (-0.9235, 0.0000, -0.5637)],
            ['H', (0.9235, 0.0000, 1.8927)],
            ['H', (-0.9235, 0.0000, 1.8927)]]
        frozen = range(2)
        nip = 12
    elif formula.lower() == 'c2h2': 
        atoms = [['C',(0.0000, 0.0000, 0.6015)],
            ['C', (0.0000, 0.0000, -0.6015)],
            ['H', (0.0000, 0.0000, 1.6615)],
            ['H', (0.0000, 0.0000, -1.6615)]]
        frozen = range(2)
        nip = 10
    elif formula.lower() == 'c4': 
        atoms = [['C',(1.2247, 0.0000, 0.0000)],
            ['C', (-1.2247, 0.0000, 0.0000)],
            ['C', (0.0000, -0.7286, 0.0000)],
            ['C', (0.0000, 0.7286, 0.0000)]]
        frozen = range(4)
        nip = 16
    elif formula.lower() == 'c3h6': 
        atoms = [['C',(0.036473, 0.859901, -0.182257)],
            ['C', (-0.275674, -0.564282, -0.600227)],
            ['C', (0.268426, -0.283892, 0.786852)],
            ['H', (-0.412409, -0.380348, 1.623541)],
            ['H', (1.285827, -0.580215, 1.010404)],
            ['H', (-0.796804, 1.523474, 0.013213)],
            ['H', (0.896783, 1.350428, -0.620593)],
            ['H', (-1.331415, -0.803627, -0.632093)],
            ['H', (0.315621, -1.079884, -1.346828)]]
        frozen = range(3)
        nip = 18
    elif formula.lower() == 'c6h6': 
        atoms = [['C',(0.0000, 1.3990, 0.0000)],
            ['C', (1.2115, 0.6995, 0.0000)],
            ['C', (1.2115, -0.6995, 0.0000)],
            ['C', (0.0000, -1.3990, 0.0000)],
            ['C', (-1.2115, -0.6995, 0.0000)],
            ['C', (-1.2115, 0.6995, 0.0000)],
            ['H', (0.0000, 2.5000, 0.0000)],
            ['H', (2.1651, 1.2500, 0.0000)],
            ['H', (2.1651, -1.2500, 0.0000)],
            ['H', (0.0000, -2.5000, 0.0000)],
            ['H', (-2.1651, -1.2500, 0.0000)],
            ['H', (-2.1651, 1.2500, 0.0000)]]
        frozen = range(6)
        nip = 30
    elif formula.lower() == 'c8h8': 
        atoms = [['C',(-0.2627, -1.6663, 0.3833)],
            ['C', (1.0331, -1.3409, 0.3827)],
            ['C', (-1.0297, 1.3407, 0.3845)],
            ['C', (0.2630, 1.6666, 0.3835)],
            ['C', (-1.3424, -1.0272, -0.3796)],
            ['C', (1.6770, -0.2635, -0.3837)],
            ['C', (-1.6841, 0.2615, -0.3911)],
            ['C', (1.3455, 1.0312, -0.3823)],
            ['H', (-0.5690, -2.5492, 0.9659)],
            ['H', (1.7214, -1.9720, 0.9656)],
            ['H', (-1.7184, 1.9710, 0.9702)],
            ['H', (0.5706, 2.5481, 0.9698)],
            ['H', (-1.9688, -1.7275, -0.9575)],
            ['H', (2.5603, -0.5678, -0.9650)],
            ['H', (-2.5689, 0.5611, -0.9710)],
            ['H', (1.9751, 1.7236, -0.9613)]]
        frozen = range(8)
        nip = 40
    elif formula.lower() == 'c5h6': 
        atoms = [['C',(0.735000, 0.000000, 0.000000)],
            ['C', (-0.735000, 0.000000, 0.000000)],
            ['C', (1.180760, 0.000000, 1.265805)],
            ['C', (-1.180760, 0.000000, 1.265805)],
            ['C', (-0.003091, 0.000000, 2.209296)],
            ['H', (2.228506, 0.000000, 1.566354)],
            ['H', (1.364644, 0.000000, -0.889746)],
            ['H', (-1.364960, 0.000000, -0.889523)],
            ['H', (-2.228838, 0.000000, 1.565193)],
            ['H', (-0.001086, 0.885447, 2.844969)],
            ['H', (-0.005702, -0.882815, 2.848618)]]
        frozen = range(5)
        nip = 26
    elif formula.lower() == 'c2h3f': 
        atoms = [['C',(0.000000, 0.000000, 0.000000)],
            ['C', (0.000000, 0.000000, 1.321000)],
            ['H', (-0.942589, 0.000000, -0.521841)],
            ['H', (-0.874292, 0.000000, 1.955045)],
            ['H', (0.922424, 0.000000, -0.561725)],
            ['F', (1.142469, 0.000000, 2.026603)]]
        frozen = range(3)
        nip = 18
    elif formula.lower() == 'c2h3cl': 
        atoms = [['C',(-0.554265, -0.445361, 0.111076)],
            ['C', (0.372254, 0.438035, -0.234540)],
            ['H', (-1.322093, -0.210763, 0.831940)],
            ['H', (-0.543697, -1.425246, -0.340536)],
            ['H', (1.153254, 0.241370, -0.951543)],
            ['Cl', (0.440430, 2.028766, 0.431795)]]
        frozen = range(7)
        nip = 18
    elif formula.lower() == 'c2h3br': 
        atoms = [['C',(0.000000, 0.000000, 0.000000)],
            ['C', (0.000000, 0.000000, 1.325600)],
            ['H', (-0.895976, 0.000000, -0.602298)],
            ['H', (-0.894897, 0.000000, 1.927173)],
            ['H', (0.908386, 0.000000, -0.581003)],
            ['Br', (1.357668, 0.000000, 2.194533)]]
        frozen = range(16)
        nip = 18
    elif formula.lower() == 'c2h3i': 
        atoms = [['C',(0.000000, 0.000000, 0.000000)],
            ['C', (0.000000, 0.000000, 1.328000)],
            ['H', (-0.903971, 0.000000, -0.595154)],
            ['H', (-0.899347, 0.000000, 1.924168)],
            ['H', (0.912883, 0.000000, -0.577101)],
            ['I', (1.747544, 0.000000, 2.461568)]]
        frozen = range(6)
        nip = 28
    elif formula.lower() == 'cf4': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['F', (0.7638, -0.7638, 0.7638)],
            ['F', (-0.7638, 0.7638, 0.7638)],
            ['F', (-0.7638, -0.7638, -0.7638)],
            ['F', (0.7638, 0.7638, -0.7638)]]
        frozen = range(5)
        nip = 32
    elif formula.lower() == 'ccl4': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['Cl', (1.0202, -1.0202, 1.0202)],
            ['Cl', (-1.0202, 1.0202, 1.0202)],
            ['Cl', (-1.0202, -1.0202, -1.0202)],
            ['Cl', (1.0202, 1.0202, -1.0202)]]
        frozen = range(21)
        nip = 32
    elif formula.lower() == 'cbr4': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['Br', (1.1172, -1.1172, 1.1172)],
            ['Br', (-1.1172, 1.1172, 1.1172)],
            ['Br', (-1.1172, -1.1172, -1.1172)],
            ['Br', (1.1172, 1.1172, -1.1172)]]
        frozen = range(57)
        nip = 32
    elif formula.lower() == 'ci4': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['I', (1.2411, -1.2411, 1.2411)],
            ['I', (-1.2411, 1.2411, 1.2411)],
            ['I', (-1.2411, -1.2411, -1.2411)],
            ['I', (1.2411, 1.2411, -1.2411)]]
        frozen = range(17)
        nip = 72
    elif formula.lower() == 'sih4': 
        atoms = [['Si',(0.0000, 0.0000, 0.0000)],
            ['H', (0.8544, -0.8544, 0.8544)],
            ['H', (-0.8544, 0.8544, 0.8544)],
            ['H', (-0.8544, -0.8544, -0.8544)],
            ['H', (0.8544, 0.8544, -0.8544)]]
        frozen = range(5)
        nip = 8
    elif formula.lower() == 'geh4': 
        atoms = [['Ge',(0.0000, 0.0000, 0.0000)],
            ['H', (0.8805, -0.8805, 0.8805)],
            ['H', (-0.8805, 0.8805, 0.8805)],
            ['H', (-0.8805, -0.8805, -0.8805)],
            ['H', (0.8805, 0.8805, -0.8805)]]
        frozen = range(9)
        nip = 18
    elif formula.lower() == 'si2h6': 
        atoms = [['Si',(0.000000, 0.000000, -1.165500)],
            ['Si', (0.000000, 0.000000, 1.165500)],
            ['H', (1.399330, 0.000000, 1.683128)],
            ['H', (-1.399330, 0.000000, -1.683128)],
            ['H', (0.699500, 1.211600, -1.683128)],
            ['H', (0.699500, -1.211600, -1.683128)],
            ['H', (-0.699500, -1.211600, 1.683128)],
            ['H', (-0.699500, 1.211600, 1.683128)]]
        frozen = range(10)
        nip = 14
    elif formula.lower() == 'si5h12': 
        atoms = [['Si',(-0.0048335, -3.8969717, -0.5238439)],
            ['H', (1.1887767, -3.9134075, -1.4252499)],
            ['H', (0.0223993, -5.1288186, 0.3252902)],
            ['H', (-1.2385400, -3.9282984, -1.3688912)],
            ['Si', (0.0104464, -1.9536989, 0.7969029)],
            ['Si', (-0.0004053, 0.0000130, -0.5100885)],
            ['H', (-1.1904082, -1.9457891, 1.6943990)],
            ['H', (1.2296666, -1.9529052, 1.6693294)],
            ['Si', (-0.0104987, 1.9536727, 0.7969268)],
            ['H', (-1.2088685, -0.0034247, -1.3978287)],
            ['H', (1.2088478, 0.0037073, -1.3964714)],
            ['Si', (0.0051940, 3.8969653, -0.5238481)],
            ['H', (-0.0191436, 5.1288161, 0.3253672)],
            ['H', (1.2377333, 3.9262510, -1.3707348)],
            ['H', (-1.1896928, 3.9156075, -1.4234610)],
            ['H', (1.1910193, 1.9496877, 1.6935745)],
            ['H', (-1.2290887, 1.9491200, 1.6702050)]]
        frozen = range(25)
        nip = 32
    elif formula.lower() == 'lih': 
        atoms = [['Li',(0.0000, 0.0000, 0.0000)],
            ['H', (0.0000, 0.0000, 1.5949)]]
        frozen = range(0)
        nip = 4
    elif formula.lower() == 'kh': 
        atoms = [['K',(0.0000, 0.0000, 0.0000)],
            ['H', (0.0000, 0.0000, 2.244)]]
        frozen = range(5)
        nip = 10
    elif formula.lower() == 'bh3': 
        atoms = [['B',(0.0000, 0.0000, 0.0000)],
            ['H', (0.0000, 0.0000, 1.19)],
            ['H', (0.0000, 1.0306, -0.595)],
            ['H', (0.0000, -1.0306, -0.595)]]
        frozen = range(1)
        nip = 6
    elif formula.lower() == 'b2h6': 
        atoms = [['B',(0.0000, 0.0000, 0.8870)],
            ['B', (0.0000, 0.0000, -0.8870)],
            ['H', (0.9960, 0.0000, 0.0000)],
            ['H', (-0.9960, 0.0000, 0.0000)],
            ['H', (0.0000, 1.0408, 1.4639)],
            ['H', (0.0000, -1.0408, 1.4639)],
            ['H', (0.0000, 1.0408, -1.4639)],
            ['H', (0.0000, -1.0408, -1.4639)]]
        frozen = range(2)
        nip = 12
    elif formula.lower() == 'nh3': 
        atoms = [['N',(0.0000, 0.0000, 0.0000)],
            ['H', (0.0000, -0.9377, -0.3816)],
            ['H', (0.8121, 0.4689, -0.3816)],
            ['H', (-0.8121, 0.4689, -0.3816)]]
        frozen = range(1)
        nip = 8
    elif formula.lower() == 'hn3': 
        atoms = [['H',(-0.9585, 0.0000, -0.3338)],
            ['N', (0.0000, 0.0000, 0.0000)],
            ['N', (0.0000, 0.0000, 1.2450)],
            ['N', (0.1617, 0.0000, 2.3674)]]
        frozen = range(3)
        nip = 16 
    elif formula.lower() == 'ph3': 
        atoms = [['P',(0.0000, 0.0000, 0.0000)],
            ['H', (0.0000, -1.1932, -0.7717)],
            ['H', (1.0333, 0.5966, -0.7717)],
            ['H', (-1.0333, 0.5966, -0.7717)]]
        frozen = range(5)
        nip = 8
    elif formula.lower() == 'ash3': 
        atoms = [['As',(0.0000, 0.0000, 0.0000)],
            ['H', (0.0000, 1.2561, 0.8398)],
            ['H', (1.0878, -0.6281, 0.8398)],
            ['H', (-1.0878, -0.6281, 0.8398)]]
        frozen = range(9)
        nip = 8
    elif formula.lower() == 'sh2' or formula.lower() == 'h2s':
        atoms = [['S',(0.0000, 0.0000, 0.0000)],
            ['H', (0.9617, 0.0000, 0.9268)],
            ['H', (-0.9617, 0.0000, 0.9268)]]
        frozen = range(5)
        nip = 8
    elif formula.lower() == 'fh' or formula.lower() == 'hf':
        atoms = [['H',(0.0000, 0.0000, 0.0000)],
            ['F', (0.0000, 0.0000, 0.9169)]]
        frozen = range(1)
        nip = 8
    elif formula.lower() == 'clh' or formula.lower() == 'hcl':
        atoms = [['H',(0.0000, 0.0000, 0.0000)],
            ['Cl', (0.0000, 0.0000, 1.2746)]]
        frozen = range(5)
        nip = 8
    elif formula.lower() == 'lif': 
        atoms = [['Li',(0.0000, 0.0000, 0.0000)],
            ['F', (0.0000, 0.0000, 1.5639)]]
        frozen = range(1)
        nip = 10
    elif formula.lower() == 'f2mg' or formula.lower() == 'mgf2':
        atoms = [['F',(0.0000, 0.0000, 1.771)],
            ['Mg', (0.0000, 0.0000, 0.0000)],
            ['F', (0.0000, 0.0000, -1.771)]]
        frozen = range(4)
        nip = 24
    elif formula.lower() == 'tif4': 
        atoms = [['Ti',(0.0000, 0.0000, 0.0000)],
            ['F', (1.0127, -1.0127, 1.0127)],
            ['F', (-1.0127, 1.0127, 1.0127)],
            ['F', (-1.0127, -1.0127, -1.0127)],
            ['F', (1.0127, 1.0127, -1.0127)]]
        frozen = range(9)
        nip = 40
    elif formula.lower() == 'alf3': 
        atoms = [['Al',(0.0000, 0.0000, 0.0000)],
            ['F', (0.0000, 0.0000, 1.633)],
            ['F', (0.0000, 1.4142, -0.8165)],
            ['F', (0.0000, -1.4142, -0.8165)]]
        frozen = range(8)
        nip = 32
    elif formula.lower() == 'bf': 
        atoms = [['B',(0.0000, 0.0000, 0.0000)],
            ['F', (0.0000, 0.0000, 1.2626)]]
        frozen = range(2)
        nip = 10
    elif formula.lower() == 'sf4': 
        atoms = [['S',(0.0000, 0.0000, 0.3726)],
            ['F', (0.0000, 1.6430, 0.2731)],
            ['F', (0.0000, -1.6430, 0.2731)],
            ['F', (1.1969, 0.0000, -0.6044)],
            ['F', (-1.1969, 0.0000, -0.6044)]]
        frozen = range(9)
        nip = 34
    elif formula.lower() == 'brk' or formula.lower() == 'kbr':
        atoms = [['Br',(0.0000, 0.0000, 0.0000)],
            ['K', (0.0000, 0.0000, 2.8208)]]
        frozen = range(19)
        nip = 16
    elif formula.lower() == 'gacl': 
        atoms = [['Ga',(0.0000, 0.0000, 0.0000)],
            ['Cl', (0.0000, 0.0000, 2.2017)]]
        frozen = range(14)
        nip = 20
    elif formula.lower() == 'nacl': 
        atoms = [['Na',(0.0000, 0.0000, 0.0000)],
            ['Cl', (0.0000, 0.0000, 2.3609)]]
        frozen = range(6)
        nip = 16
    elif formula.lower() == 'mgcl2': 
        atoms = [['Mg',(0.0000, 0.0000, 0.0000)],
            ['Cl', (0.0000, 0.0000, 2.179)],
            ['Cl', (0.0000, 0.0000, -2.179)]]
        frozen = range(12)
        nip = 24
    elif formula.lower() == 'ali3': 
        atoms = [['Al',(0.0000, 0.0000, 0.0000)],
            ['I', (0.0000, 0.0000, 2.461)],
            ['I', (0.0000, 2.1313, -1.2305)],
            ['I', (0.0000, -2.1313, -1.2305)]]
        frozen = range(17)
        nip = 62
    elif formula.lower() == 'bn': 
        atoms = [['B',(0.0000, 0.0000, 0.0000)],
            ['N', (0.0000, 0.0000, 1.281)]]
        frozen = range(2)
        nip = 8
    elif formula.lower() == 'nch' or formula.lower() == 'cnh' or formula.lower() == 'hcn':
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['H', (0.0000, 0.0000, 1.0655)],
            ['N', (0.0000, 0.0000, -1.1532)]]
        frozen = range(2)
        nip = 10
    elif formula.lower() == 'pn': 
        atoms = [['P',(0.0000, 0.0000, 0.0000)],
            ['N', (0.0000, 0.0000, 1.49087)]]
        frozen = range(6)
        nip = 10
    elif formula.lower() == 'h2nnh2' or formula.lower() == 'n2h4':
        atoms = [['N',(0.0000, 0.7230, -0.1123)],
            ['N', (0.0000, -0.7230, -0.1123)],
            ['H', (-0.4470, 1.0031, 0.7562)],
            ['H', (0.4470, -1.0031, 0.7562)],
            ['H', (0.9663, 1.0031, 0.0301)],
            ['H', (-0.9663, -1.0031, 0.0301)]]
        frozen = range(2)
        nip = 14
    elif formula.lower() == 'h2co' or formula.lower() == 'coh2':
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['O', (0.0000, 0.0000, 1.208)],
            ['H', (0.9490, 0.0000, -0.5873)],
            ['H', (-0.9490, 0.0000, -0.5873)]]
        frozen = range(2)
        nip = 12
    elif formula.lower() == 'ch3oh' or formula.lower() == 'ch4o' or formula.lower() == 'coh4':
        atoms = [['C',(-0.722791, -0.007039, 0.000000)],
            ['O', (0.701687, 0.011691, 0.000000)],
            ['H', (-1.022488, -1.059189, 0.000000)],
            ['H', (-1.162308, 0.455180, -0.888335)],
            ['H', (-1.148266, 0.468270, 0.888264)],
            ['H', (0.990233, 0.911667, 0.000000)]]
        frozen = range(2)
        nip = 14 
    elif formula.lower() == 'c2h6o' or formula.lower() == 'c2oh6':
        atoms = [['C',(1.1879, -0.3829, 0.0000)],
            ['C', (0.0000, 0.5526, 0.0000)],
            ['O', (-1.1867, -0.2472, 0.0000)],
            ['H', (-1.9237, 0.3850, 0.0000)],
            ['H', (2.0985, 0.2306, 0.0000)],
            ['H', (1.1184, -1.0093, 0.8869)],
            ['H', (1.1184, -1.0093, -0.8869)],
            ['H', (-0.0227, 1.1812, 0.8852)],
            ['H', (-0.0227, 1.1812, -0.8852)]]
        frozen = range(3)
        nip = 20
    elif formula.lower() == 'c2h4o' or formula.lower() == 'c2oh4':
        atoms = [['C',(0.000000, 0.000000, 0.000000)],
            ['C', (0.000000, 0.000000, 1.515000)],
            ['O', (1.001953, 0.000000, 2.193373)],
            ['H', (-1.019805, 0.000000, 1.997060)],
            ['H', (-0.905700, -0.522900, -0.363000)],
            ['H', (0.000000, 1.045800, -0.363000)],
            ['H', (0.905700, -0.522900, -0.363000)]]
        frozen = range(3)
        nip = 18
    elif formula.lower() == 'c4h10o' or formula.lower() == 'c4oh10':
        atoms = [['O',(0.0000, 0.0000, 0.2696)],
            ['C', (0.0000, 1.1705, -0.5184)],
            ['C', (0.0000, -1.1705, -0.5184)],
            ['C', (0.0000, 2.3716, 0.4082)],
            ['C', (0.0000, -2.3716, 0.4082)],
            ['H', (-0.8879, 1.1870, -1.1676)],
            ['H', (0.8879, 1.1870, -1.1676)],
            ['H', (0.8879, -1.1870, -1.1676)],
            ['H', (-0.8879, -1.1870, -1.1676)],
            ['H', (0.0000, 3.2961, -0.1729)],
            ['H', (0.0000, -3.2961, -0.1729)],
            ['H', (0.8840, 2.3552, 1.0456)],
            ['H', (-0.8840, 2.3552, 1.0456)],
            ['H', (-0.8840, -2.3552, 1.0456)],
            ['H', (0.8840, -2.3552, 1.0456)]]
        frozen = range(5)
        nip = 32
    elif formula.lower() == 'ch2o2' or formula.lower() == 'co2h2':
        atoms = [['O',(0.9858, 0.0000, 2.0307)],
            ['H', (-1.0241, 0.0000, 1.7361)],
            ['C', (0.0000, 0.0000, 1.3430)],
            ['O', (0.0000, 0.0000, 0.0000)],
            ['H', (0.9329, 0.0000, -0.2728)]]
        frozen = range(3)
        nip = 18 
    elif formula.lower() == 'hooh' or formula.lower() == 'h2o2':
        atoms = [['O',(0.0000, 0.7375, -0.0528)],
            ['O', (0.0000, -0.7375, -0.0528)],
            ['H', (0.8190, 0.8170, 0.4220)],
            ['H', (-0.8190, -0.8170, 0.4220)]]
        frozen = range(2)
        nip = 14
    elif formula.lower() == 'h2o': 
        #atoms = [['O',(0.0000, 0.0000, -0.0644484)],
        #    ['H', ( 0.7499149, 0.0000, 0.5114912)],
        #    ['H', (-0.7499149, 0.0000, 0.5114912)]] # gw27
        atoms = [['O',(0.0000, 0.0000, 0.0000)],
            ['H', (0.7571, 0.0000, 0.5861)],
            ['H', (-0.7571, 0.0000, 0.5861)]] # gw100
        frozen = range(1)
        nip = 8
    elif formula.lower() == 'co2': 
        atoms = [['O',(0.0000, 0.0000, 1.16)],
            ['C', (0.0000, 0.0000, 0.0000)],
            ['O', (0.0000, 0.0000, -1.16)]]
        frozen = range(3)
        nip = 16
    elif formula.lower() == 'cs2': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['S', (0.0000, 0.0000, 1.5526)],
            ['S', (0.0000, 0.0000, -1.5526)]]
        frozen = range(11)
        nip = 16
    elif formula.lower() == 'ocs' or formula.lower() == 'cos':
        atoms = [['O',(0.0000, 0.0000, 1.1578)],
            ['C', (0.0000, 0.0000, 0.0000)],
            ['S', (0.0000, 0.0000, -1.5601)]]
        frozen = range(7)
        nip = 16
    elif formula.lower() == 'ocse' or formula.lower() == 'seco': 
        atoms = [['O',(0.0000, 0.0000, 1.159)],
            ['C', (0.0000, 0.0000, 0.0000)],
            ['Se', (0.0000, 0.0000, -1.709)]]
        frozen = range(7)
        nip = 16
    elif formula.lower() == 'co': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['O', (0.0000, 0.0000, 1.283)]]
        frozen = range(2)
        nip = 10
    elif formula.lower() == 'o3': 
        atoms = [['O',(0.0000, 0.0000, 0.0000)],
            ['O', (1.0869, 0.0000, 0.6600)],
            ['O', (-1.0869, 0.0000, 0.6600)]]
        frozen = range(3)
        nip = 18
    elif formula.lower() == 'so2': 
        atoms = [['S',(0.0000, 0.0000, 0.0000)],
            ['O', (1.2349, 0.0000, 0.7226)],
            ['O', (-1.2349, 0.0000, 0.7226)]]
        frozen = range(7)
        nip = 18
    elif formula.lower() == 'beo': 
        atoms = [['Be',(0.0000, 0.0000, 0.0000)],
            ['O', (0.0000, 0.0000, 1.3308)]]
        frozen = range(2)
        nip = 10
    elif formula.lower() == 'mgo': 
        atoms = [['Mg',(0.0000, 0.0000, 0.0000)],
            ['O', (0.0000, 0.0000, 1.749)]]
        frozen = range(3)
        nip = 16
    elif formula.lower() == 'c7h8': 
        atoms = [['C',(-1.091600, -0.874900, 0.000000)],
            ['C', (0.211900, -1.382800, 0.000000)],
            ['C', (1.303400, -0.507900, 0.000000)],
            ['C', (1.091600, 0.874900, 0.000000)],
            ['C', (-0.211900, 1.382700, 0.000000)],
            ['C', (-1.303500, 0.507800, 0.000000)],
            ['H', (-1.957699, -1.569142, 0.000000)],
            ['H', (0.380087, -2.479984, 0.000000)],
            ['H', (1.957699, 1.569142, 0.000000)],
            ['H', (-0.380072, 2.479886, 0.000000)],
            ['H', (-2.337729, 0.910876, 0.000000)],
            ['C', (2.723481, -1.061023, 0.000000)],
            ['H', (3.397184, -0.350813, 0.523286)],
            ['H', (2.739366, -2.039786, 0.523326)],
            ['H', (3.068240, -1.195306, -1.046523)]]
        frozen = range(7)
        nip = 36 
    elif formula.lower() == 'c8h10': 
        atoms = [['C',(-2.2693535, -0.0000389, -0.2398724)],
            ['C', (-1.5797056, -1.2063053, -0.1005171)],
            ['C', (-0.2110721, -1.2030110, 0.1749198)],
            ['C', (0.4952604, 0.0000401, 0.3167968)],
            ['C', (-0.2111286, 1.2030501, 0.1748811)],
            ['C', (-1.5797652, 1.2062634, -0.1005510)],
            ['H', (-3.3389696, -0.0000690, -0.4503195)],
            ['H', (-2.1102702, -2.1538484, -0.2012097)],
            ['H', (0.3195630, -2.1509209, 0.2885225)],
            ['H', (0.3194582, 2.1509892, 0.2884519)],
            ['H', (-2.1103902, 2.1537683, -0.2012753)],
            ['C', (2.8147071, -0.0000376, -0.7147854)],
            ['C', (1.9829690, 0.0000498, 0.5777693)],
            ['H', (2.5926203, -0.8860058, -1.3248301)],
            ['H', (2.5930639, 0.8861475, -1.3246747)],
            ['H', (3.8904081, -0.0003286, -0.4914695)],
            ['H', (2.2473809, -0.8820350, 1.1803103)],
            ['H', (2.2474159, 0.8821780, 1.1802303)]]
        frozen = range(8)
        nip = 42 
    elif formula.lower() == 'c6f6': 
        atoms = [['C',(-1.092692, -0.875775, 0.000000)],
            ['C', (0.212112, -1.384183, 0.000000)],
            ['C', (1.304703, -0.508408, 0.000000)],
            ['C', (1.092692, 0.875775, 0.000000)],
            ['C', (-0.212112, 1.384083, 0.000000)],
            ['C', (-1.304804, 0.508308, 0.000000)],
            ['F', (-2.126549, -1.704487, 0.000000)],
            ['F', (0.412876, -2.693885, 0.000000)],
            ['F', (2.539354, -0.989305, 0.000000)],
            ['F', (2.126549, 1.704487, 0.000000)],
            ['F', (-0.412858, 2.693787, 0.000000)],
            ['F', (-2.539356, 0.989457, 0.000000)]]
        frozen = range(12)
        nip = 66
    elif formula.lower() == 'c6h5oh' or formula.lower() == 'c6h6o': 
        atoms = [['C',(-1.046085, -0.892147, -0.000000)],
            ['C', (0.257414, -1.400049, 0.000000)],
            ['C', (1.331097, -0.503372, -0.000000)],
            ['C', (1.091601, 0.874901, -0.000000)],
            ['C', (-0.121202, 1.347367, 0.000000)],
            ['C', (-1.230130, 0.494536, 0.000000)],
            ['H', (-1.874522, -1.578781, 0.001032)],
            ['H', (0.431625, -2.467932, 0.001287)],
            ['H', (2.336451, -0.886828, 0.000832)],
            ['H', (1.937051, 1.553332, -0.000803)],
            ['O', (-0.312498, 2.697885, -0.001272)],
            ['H', (-2.244385, 0.877082, -0.000405)],
            ['H', (-1.251130, 2.879281, -0.002039)]]
        frozen = range(7)
        nip = 36 
    elif formula.lower() == 'c6h5nh2' or formula.lower() == 'c6nh7': 
        atoms = [['C',(-1.086143, -0.870526, 0.000000)],
            ['C', (0.210840, -1.375886, 0.000000)],
            ['C', (1.296883, -0.505360, 0.000000)],
            ['C', (1.086142, 0.870526, 0.000000)],
            ['C', (-0.210841, 1.375786, 0.000000)],
            ['C', (-1.296983, 0.505261, 0.000000)],
            ['H', (-1.932704, -1.548451, 0.000000)],
            ['H', (0.374980, -2.447943, 0.000000)],
            ['H', (2.307474, -0.899002, 0.000000)],
            ['H', (1.932383, 1.548850, 0.000000)],
            ['H', (-2.307832, 0.898242, 0.000000)],
            ['N', (-0.428501, 2.790157, 0.000000)],
            ['H', (0.323567, 3.340664, 0.346569)],
            ['H', (-1.327164, 3.070170, 0.333980)]]
        frozen = range(7)
        nip = 36 
    elif formula.lower() == 'c5h5n': 
        atoms = [['N',(0.000000, 0.000000, 0.000000)],
            ['C', (-0.476428, -1.252444, 0.000000)],
            ['C', (-0.903103, 0.989952, 0.000000)],
            ['C', (-2.282876, 0.784403, 0.000000)],
            ['C', (-1.835282, -1.567988, 0.000000)],
            ['C', (-2.760265, -0.525306, 0.000000)],
            ['H', (-0.532213, 2.008528, 0.000000)],
            ['H', (0.266630, -2.041697, 0.000000)],
            ['H', (-2.958369, 1.628364, 0.000000)],
            ['H', (-2.153556, -2.601071, 0.000000)],
            ['H', (-3.818275, -0.726658, 0.000000)]]
        frozen = range(6)
        nip = 30
    elif formula.lower() == 'c5h5n5o' or formula.lower() == 'c5n5h5o': 
        atoms = [['C',(-0.8909136, 0.0022495, 0.4879726)],
            ['C', (0.4648657, 0.0066008, 0.8428894)],
            ['N', (-1.4589692, 0.0149180, -0.7432767)],
            ['C', (-0.5646417, 0.0081792, -1.7097505)],
            ['N', (0.6167192, 0.0012409, 2.2159144)],
            ['H', (-0.8858269, -0.0099074, 3.7340662)],
            ['C', (-0.6098052, -0.0051706, 2.6839376)],
            ['N', (-1.5660059, -0.0044593, 1.6825133)],
            ['H', (-2.5739287, -0.0104122, 1.7887665)],
            ['C', (1.4519352, 0.0039931, -0.2048012)],
            ['O', (2.6727207, -0.0060475, -0.1670731)],
            ['N', (0.7873252, 0.0064149, -1.4864710)],
            ['H', (1.4327355, -0.0565403, -2.2706380)],
            ['N', (-0.9871915, -0.0557168, -3.0197562)],
            ['H', (-1.9795941, 0.1251659, -3.1279347)],
            ['H', (-0.4045996, 0.3813093, -3.7247680)]]
        frozen = range(11)
        nip = 56
    elif formula.lower() == 'c5h5n5' or formula.lower() == 'c5n5h5': 
        atoms = [['C',(-0.7843450, 0.0024660, 0.6854944)],
            ['C', (0.5301823, 0.0009168, 0.1951947)],
            ['N', (-1.9138024, 0.0022584, -0.0334730)],
            ['C', (-1.6479109, -0.0019330, -1.3472026)],
            ['H', (-2.5169904, -0.0044917, -2.0095241)],
            ['N', (-0.4540095, -0.0051210, -1.9657824)],
            ['C', (0.6617763, -0.0009654, -1.2107858)],
            ['N', (1.8686255, 0.0181736, -1.8266445)],
            ['H', (2.7131398, -0.0801668, -1.2801876)],
            ['H', (1.9011412, -0.0813319, -2.8324875)],
            ['N', (1.4556976, -0.0028403, 1.2254693)],
            ['H', (1.1016503, -0.0046108, 3.3314279)],
            ['C', (0.7173645, -0.0023279, 2.3155892)],
            ['N', (-0.6380338, 0.0012265, 2.0572467)],
            ['H', (-1.3931273, 0.0022322, 2.7328517)]]
        frozen = range(10)
        nip = 50
    elif formula.lower() == 'c4h5n3o': 
        atoms = [['H',(-2.0638946, 1.7581987, -0.0048606)],
            ['C', (-1.1537688, 1.1649096, 0.0014411)],
            ['C', (0.0751951, 1.7542640, 0.0005025)],
            ['H', (0.2153507, 2.8348293, 0.0000624)],
            ['N', (1.1910674, 0.9892600, -0.0011780)],
            ['H', (2.1178150, 1.4035814, -0.0026938)],
            ['C', (1.1663885, -0.4437838, -0.0000952)],
            ['O', (2.2347026, -1.0410121, -0.0014923)],
            ['N', (-0.0756682, -1.0234974, 0.0071744)],
            ['C', (-1.1667470, -0.2723068, 0.0031814)],
            ['N', (-2.3615150, -0.9269214, -0.0250037)],
            ['H', (-2.3405765, -1.9329874, 0.0897975)],
            ['H', (-3.2271802, -0.4358623, 0.1455697)]]
        frozen = range(8)
        nip = 42
    elif formula.lower() == 'c5h6n2o2' or formula.lower() == 'c5o2n2h6': 
        atoms = [['C',(0.5676469, 0.0000748, -1.1919386)],
            ['C', (1.5304659, 0.0002388, -0.2353148)],
            ['H', (2.5926489, 0.0003404, -0.4816273)],
            ['C', (-0.8332110, 0.0000968, -0.7623841)],
            ['O', (-1.8038589, 0.0001316, -1.5105895)],
            ['N', (-1.0160281, 0.0001744, 0.6372389)],
            ['H', (-1.9813565, 0.0002431, 0.9610129)],
            ['C', (-0.0490742, 0.0002212, 1.6309425)],
            ['O', (-0.2873837, -0.0005911, 2.8289393)],
            ['N', (1.2432728, 0.0002954, 1.1110067)],
            ['H', (1.9834347, 0.0004963, 1.8040615)],
            ['C', (0.8557798, -0.0004840, -2.6602502)],
            ['H', (1.9357502, -0.0001999, -2.8533074)],
            ['H', (0.4097225, 0.8785617, -3.1465795)],
            ['H', (0.4104462, -0.8804337, -3.1455944)]]
        frozen = range(9)
        nip = 48
    elif formula.lower() == 'c4h4n2o2': 
        atoms = [['H',(1.7181113, -0.0000002, -2.1244327)],
            ['C', (1.1438667, -0.0000001, -1.2038069)],
            ['C', (1.7446080, -0.0000000, 0.0097511)],
            ['H', (2.8271212, -0.0000001, 0.1298240)],
            ['C', (-0.3090145, 0.0000000, -1.2970091)],
            ['O', (-0.9725128, -0.0000001, -2.3249912)],
            ['N', (-0.9523747, 0.0000001, -0.0343227)],
            ['H', (-1.9701793, 0.0000002, -0.0511160)],
            ['C', (-0.3751368, 0.0000001, 1.2248796)],
            ['O', (-0.9991833, -0.0000001, 2.2733353)],
            ['N', (1.0223980, 0.0000001, 1.1766034)],
            ['H', (1.4813173, 0.0000001, 2.0806653)]]
        frozen = range(8)
        nip = 42
    elif formula.lower() == 'ag2': 
        atoms = [['Ag',(0, 0, 0)],
            ['Ag', (0, 0, 2.5335)]]
        frozen = range(2)
        nip = 38
    elif formula.lower() == 'cu2': 
        atoms = [['Cu',(0.0, 0.0, 0.0)],
            ['Cu', (0.0, 0.0, 2.2197)]]
        frozen = range(18)
        nip = 38
    elif formula.lower() == 'nccu' or formula.lower() == 'cucn': 
        atoms = [['C',(0.0000, 0.0000, 0.0000)],
            ['N', (0.0000, 0.0000, 1.158)],
            ['Cu', (0.0000, 0.0000, -1.832)]]
        frozen = range(11)
        nip = 28
    elif formula.lower() == 'ch4n2o' or formula.lower() == 'con2h4': 
        atoms = [['O',(0.0000, 1.3049, 0.0000)],
            ['C', (0.0000, 0.0838, 0.0000)],
            ['N', (1.1603, -0.6595, 0.0000)],
            ['N', (-1.1603, -0.6595, -0.0000)],
            ['H', (1.1383, -1.5964, 0.3424)],
            ['H', (1.9922, -0.0940, 0.1760)],
            ['H', (-1.1383, -1.5964, -0.3424)],
            ['H', (-1.9922, -0.0940, -0.1760)]]
        frozen = range(4)
        nip = 24
    else:
        print "Formula", formula, "not found in the GW100!"
    return atoms, frozen, nip

def get_id_from_formula(formula):
    if formula.lower() == 'he': 
        id = 1
    elif formula.lower() == 'ne': 
        id = 2
    elif formula.lower() == 'ar': 
        id = 3
    elif formula.lower() == 'kr': 
        id = 4
    elif formula.lower() == 'xe': 
        id = 5
    elif formula.lower() == 'h2': 
        id = 6
    elif formula.lower() == 'li2': 
        id = 7
    elif formula.lower() == 'na2': 
        id = 8
    elif formula.lower() == 'na4': 
        id = 9
    elif formula.lower() == 'na6': 
        id = 10
    elif formula.lower() == 'k2': 
        id = 11
    elif formula.lower() == 'rb2': 
        id = 12
    elif formula.lower() == 'n2': 
        id = 13
    elif formula.lower() == 'p2': 
        id = 14
    elif formula.lower() == 'as2': 
        id = 15
    elif formula.lower() == 'f2': 
        id = 16
    elif formula.lower() == 'cl2': 
        id = 17
    elif formula.lower() == 'br2': 
        id = 18
    elif formula.lower() == 'i2': 
        id = 19
    elif formula.lower() == 'ch4': 
        id = 20
    elif formula.lower() == 'c2h6': 
        id = 21
    elif formula.lower() == 'c3h8': 
        id = 22
    elif formula.lower() == 'c4h10': 
        id = 23
    elif formula.lower() == 'c2h4': 
        id = 24
    elif formula.lower() == 'c2h2': 
        id = 25
    elif formula.lower() == 'c4': 
        id = 26
    elif formula.lower() == 'c3h6': 
        id = 27
    elif formula.lower() == 'c6h6': 
        id = 28
    elif formula.lower() == 'c8h8': 
        id = 29
    elif formula.lower() == 'c5h6': 
        id = 30
    elif formula.lower() == 'c2h3f': 
        id = 31
    elif formula.lower() == 'c2h3cl': 
        id = 32
    elif formula.lower() == 'c2h3br': 
        id = 33
    elif formula.lower() == 'c2h3i': 
        id = 34
    elif formula.lower() == 'cf4': 
        id = 35
    elif formula.lower() == 'ccl4': 
        id = 36
    elif formula.lower() == 'cbr4': 
        id = 37
    elif formula.lower() == 'ci4': 
        id = 38
    elif formula.lower() == 'sih4': 
        id = 39
    elif formula.lower() == 'geh4': 
        id = 40
    elif formula.lower() == 'si2h6': 
        id = 41
    elif formula.lower() == 'si5h12': 
        id = 42
    elif formula.lower() == 'lih': 
        id = 43
    elif formula.lower() == 'kh': 
        id = 44
    elif formula.lower() == 'bh3': 
        id = 45
    elif formula.lower() == 'b2h6': 
        id = 46
    elif formula.lower() == 'nh3': 
        id = 47
    elif formula.lower() == 'hn3': 
        id = 48
    elif formula.lower() == 'ph3': 
        id = 49
    elif formula.lower() == 'ash3': 
        id = 50
    elif formula.lower() == 'sh2' or formula.lower() == 'h2s':
        id = 51
    elif formula.lower() == 'fh' or formula.lower() == 'hf':
        id = 52
    elif formula.lower() == 'clh' or formula.lower() == 'hcl':
        id = 53
    elif formula.lower() == 'lif': 
        id = 54
    elif formula.lower() == 'f2mg' or formula.lower() == 'mgf2':
        id = 55
    elif formula.lower() == 'tif4': 
        id = 56
    elif formula.lower() == 'alf3': 
        id = 57
    elif formula.lower() == 'bf': 
        id = 58
    elif formula.lower() == 'sf4': 
        id = 59
    elif formula.lower() == 'brk' or formula.lower() == 'kbr':
        id = 60
    elif formula.lower() == 'gacl': 
        id = 61
    elif formula.lower() == 'nacl': 
        id = 62
    elif formula.lower() == 'mgcl2': 
        id = 63
    elif formula.lower() == 'ali3': 
        id = 64
    elif formula.lower() == 'bn': 
        id = 65
    elif formula.lower() == 'nch' or formula.lower() == 'cnh' or formula.lower() == 'hcn':
        id = 66
    elif formula.lower() == 'pn': 
        id = 67
    elif formula.lower() == 'h2nnh2' or formula.lower() == 'n2h4':
        id = 68
    elif formula.lower() == 'h2co' or formula.lower() == 'coh2':
        id = 69
    elif formula.lower() == 'ch3oh' or formula.lower() == 'ch4o' or formula.lower() == 'coh4':
        id = 70
    elif formula.lower() == 'c2h6o' or formula.lower() == 'c2oh6':
        id = 71
    elif formula.lower() == 'c2h4o' or formula.lower() == 'c2oh4':
        id = 72
    elif formula.lower() == 'c4h10o' or formula.lower() == 'c4oh10':
        id = 73
    elif formula.lower() == 'ch2o2' or formula.lower() == 'co2h2':
        id = 74
    elif formula.lower() == 'hooh' or formula.lower() == 'h2o2':
        id = 75
    elif formula.lower() == 'h2o': 
        id = 76
    elif formula.lower() == 'co2': 
        id = 77
    elif formula.lower() == 'cs2': 
        id = 78
    elif formula.lower() == 'ocs' or formula.lower() == 'cos':
        id = 79
    elif formula.lower() == 'ocse' or formula.lower() == 'seco': 
        id = 80
    elif formula.lower() == 'co': 
        id = 81
    elif formula.lower() == 'o3': 
        id = 82
    elif formula.lower() == 'so2': 
        id = 83
    elif formula.lower() == 'beo': 
        id = 84
    elif formula.lower() == 'mgo': 
        id = 85
    elif formula.lower() == 'c7h8': 
        id = 86
    elif formula.lower() == 'c8h10': 
        id = 87
    elif formula.lower() == 'c6f6': 
        id = 88
    elif formula.lower() == 'c6h5oh' or formula.lower() == 'c6h6o': 
        id = 89
    elif formula.lower() == 'c6h5nh2' or formula.lower() == 'c6nh7': 
        id = 90 
    elif formula.lower() == 'c5h5n': 
        id = 91 
    elif formula.lower() == 'c5h5n5o' or formula.lower() == 'c5n5h5o': 
        id = 92 
    elif formula.lower() == 'c5h5n5' or formula.lower() == 'c5n5h5': 
        id = 93 
    elif formula.lower() == 'c4h5n3o': 
        id = 94 
    elif formula.lower() == 'c5h6n2o2' or formula.lower() == 'c5o2n2h6': 
        id = 95 
    elif formula.lower() == 'c4h4n2o2': 
        id = 96 
    elif formula.lower() == 'ag2': 
        id = 97 
    elif formula.lower() == 'cu2': 
        id = 98 
    elif formula.lower() == 'nccu' or formula.lower() == 'cucn': 
        id = 99 
    elif formula.lower() == 'ch4n2o' or formula.lower() == 'con2h4': 
        id = 100 
    else:
        print "Formula", formula, "not found in the GW100!"
    return id 

